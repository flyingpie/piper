@using Piper.Core
<div class="diagram-node" style="background-color: var(--rz-base-800); border-radius: .3em;">

	<RadzenStack Orientation="Orientation.Vertical">
		<RadzenStack
			Orientation="Orientation.Horizontal"
			AlignItems="AlignItems.Center"
			JustifyContent="JustifyContent.SpaceBetween"
			Style="background-color: var(--rz-secondary); margin: -20px -20px 0 -20px; padding: .6em;"
		>
			<h3 style="margin: 0;">Command</h3>

			<RadzenStack Orientation="Orientation.Horizontal">
				<RadzenProgressBarCircular
					ProgressBarStyle="ProgressBarStyle.Primary"
					Value="100"
					ShowValue="false"
					Visible="@NodeModel.IsExecuting"
					Mode="ProgressBarMode.Indeterminate"
					Size="ProgressBarCircularSize.ExtraSmall"
				/>
				<RadzenButton
					Click="async () => await NodeModel.ExecuteAsync()"
					Size="ButtonSize.ExtraSmall"
					Icon="play_arrow"
					Disabled="@NodeModel.IsExecuting"
				/>
			</RadzenStack>
		</RadzenStack>

		<div class="piper-field">
			Command
			<RadzenTextBox Placeholder="cmd" Style="width: 100%;" @bind-Value="NodeModel.Command"/>
		</div>

		@foreach (var arg in NodeModel.Args)
		{
			<div class="piper-field">
				Argument
				<RadzenStack Orientation="Orientation.Horizontal">
					<RadzenTextBox Placeholder="args" Style="width: 100%;" @bind-Value="arg.Arg"/>
					<RadzenButton Icon="close" Size="ButtonSize.ExtraSmall" ButtonStyle="ButtonStyle.Danger" Click="@(() => NodeModel.Args.Remove(arg))" />
				</RadzenStack>
			</div>
		}

		<div class="piper-field">
			<RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End">
				<RadzenButton
					Icon="add"
					Size="ButtonSize.ExtraSmall"
					ButtonStyle="ButtonStyle.Primary"
					Click="@(() => NodeModel.Args.Add(new Core.ListFilesNodeModel.CmdArgument()))"
				/>
			</RadzenStack>
		</div>

		<span class="piper-node-separator"></span>

		<PiperNodePort Port="NodeModel.StdIn" SelectDataFrame="() => NodeModel.StdInData" />
		<PiperNodePort Port="NodeModel.StdOut" SelectDataFrame="() => NodeModel.StdOutData" />
		<PiperNodePort Port="NodeModel.StdErr" SelectDataFrame="() => NodeModel.StdErrData" />
	</RadzenStack>

</div>

<style>
.piper-node-separator {
	border-bottom: 1px var(--rz-base-600) solid;
}

.piper-field {
	position: relative;
}
</style>